"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;exports.evaluateRuleForConfiguration=evaluateRuleForConfiguration;exports.getConfigurationMap=getConfigurationMap;exports.getEvaluation=getEvaluation;exports.getRuleMap=getRuleMap;var _debug=_interopRequireDefault(require("debug"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}const log=(0,_debug.default)('render-script');log('`render-script` is awake');const RULE_MAP=new Map();const isTruthy=v=>Boolean((v||'').trim());function evaluate(rule,configuration){function isSubRuleValid(subRule){return subRule.startsWith('!')?configuration.includes('+'+subRule.substring(1))!==true:configuration.includes('+'+subRule);}function isTopRuleValid(topRule){return topRule.split('/').filter(isTruthy).some(isSubRuleValid);}function isRuleSetValid(ruleSet){return ruleSet.split('+').filter(isTruthy).every(isTopRuleValid);}function evaluateRule(rule){return rule.split(';').filter(isTruthy).some(isRuleSetValid);}return evaluateRule(rule);}function evaluateRuleForConfiguration(rule='',configuration=''){return isTruthy(rule)?isTruthy(configuration)?evaluate(rule,configuration):false:false;}function getRuleMap(ruleMap=RULE_MAP){return ruleMap;}function getConfigurationMap(ruleMap=new Map(),rule=''){let configurationMap;if(ruleMap.has(rule)){configurationMap=ruleMap.get(rule);}else{ruleMap.set(rule,configurationMap=new Map());}return configurationMap;}function getEvaluation(configurationMap=new Map(),rule='',configuration=''){let evaluation;if(configurationMap.has(configuration)){evaluation=configurationMap.get(configuration);}else{configurationMap.set(configuration,evaluation=evaluateRuleForConfiguration(rule,configuration));}return evaluation;}var _default=(rule='',configuration='')=>isTruthy(rule)?isTruthy(configuration)?getEvaluation(getConfigurationMap(getRuleMap(),rule),rule,configuration):false:false;exports.default=_default;